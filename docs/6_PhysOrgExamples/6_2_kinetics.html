

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Investigating Reaction Kinetics &#8212; Steal this Code</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tufte.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6_PhysOrgExamples/6_2_kinetics';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Problem 5, Ch. 7" href="6_3_Problem_ch7_p5.html" />
    <link rel="prev" title="Integrating Rate Equations with Python" href="6_1_start.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../start.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/Ouroboros-benzene.svg.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/Ouroboros-benzene.svg.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../start.html">
                    Steal This Code
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1_Math/1_1_Calculator.html">Basic Math with <em>Python</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Math/1_2_uncertainties.html">Using Uncertainty</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MatPlotLib</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_1_Plotting.html">Plotting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_2_Curve_Fits.html">Linear Fits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_3_Curve_Fits.html">Curve Fits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_4_Fancy_1.html">Advanced Plotting Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_5_Notes.html">Notes on Fitting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_MatPlotLib/2_6_Plotting_Reaction_Kinetics_to_Determine_Order.html">Plotting Reaction Kinetics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SymPy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3_SymPy/K01_solving_with_sympy.html">Free Symbolic Math</a></li>

<li class="toctree-l1"><a class="reference internal" href="../3_SymPy/K02_Integrating_Rate_Law_1.html">Integrating Rate Laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_SymPy/K03_Integrating_MM.html">Integrating the Michaelis-Menten Rate Law</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SciPy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4_SciPy/K04_NumericIntegration.html">Numeric Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_SciPy/K05_NumericIntegration_SystemEq.html">Integrating a System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PhysOrg Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="6_0_Introduction.html">Intro to PhysOrg Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_1_start.html">Integrating Rate Equations with Python</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Investigating Reaction Kinetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_3_Problem_ch7_p5.html">Problem 5, Ch. 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_4_Problem_ch_7_p_9.html">Problem 9, Chapter 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_5_Problem_ch7_p11.html">Problem 11, Chapter 7</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/blinkletter/StealThisCode/blob/main/./6_PhysOrgExamples/6_2_kinetics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/6_PhysOrgExamples/6_2_kinetics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Investigating Reaction Kinetics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#order-of-reaction">Order of Reaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models">Linear Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fits">Curve Fits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-curve-fits">Evaluating the Curve Fits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-two-products">The Two products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-set">The Data Set</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="investigating-reaction-kinetics">
<h1>Investigating Reaction Kinetics<a class="headerlink" href="#investigating-reaction-kinetics" title="Permalink to this headline">#</a></h1>
<p>I have a set of data reporting the concentrations over time for the following reaction.</p>
<div class="math notranslate nohighlight">
\[\begin{split} A \xrightarrow{k_1} B \\
A \xrightarrow{k_2} C\end{split}\]</div>
<p>There are two possible products. Can we find both rate constants from the observation of concentrations over time?</p>
<p><em>Note: To use this notebook, you must create a data file using the data set at the very end of this document.</em></p>
<div class="section" id="order-of-reaction">
<h2>Order of Reaction<a class="headerlink" href="#order-of-reaction" title="Permalink to this headline">#</a></h2>
<p>First, we will load in the data and make a quick plot. We observe that the two products are not being produced at equal rates.  This is consistent with the reaction scheme.  Each product is produced by a different reaction and each has its own rate constant. From the plot that correctly describes the decay of reactant, we can also obtain the overall rate consant, <span class="math notranslate nohighlight">\(k_{obs} = k_1 + k_2\)</span>. For more see the tutorial document on <a class="reference external" href="https://moodle31.upei.ca/mod/resource/view.php?id=623407">Integrating Rate Equations</a> available on the Moodle site..</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################</span>
<span class="c1">### import packages ###</span>
<span class="c1">#######################</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/blinkletter/StealThisCode/main/&quot;</span>
<span class="c1">#path = &quot;../&quot;</span>
<span class="c1">#########################################</span>
<span class="c1">### Setup a figure with a single plot ###</span>
<span class="c1">### and choose a stylesheet           ###</span>
<span class="c1">#########################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span>  <span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>                    <span class="c1"># This stylesheet must be in same folder as this notebook      </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># setup figure and plot (ax) within figure</span>
<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>


<span class="c1">#####################</span>
<span class="c1">### Load data set ###</span>
<span class="c1">#####################</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data/Mystery_Reaction.csv&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>         <span class="c1"># Load data from .csv format into dataframe</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                <span class="c1"># Show header and first three lines of dataframe</span>


<span class="c1">#############################</span>
<span class="c1">### Plot each data series ###</span>
<span class="c1">#############################</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Reactant&quot;</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">],</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span>  <span class="c1"># &quot;^&quot; will give a diamond data marker</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product B&quot;</span><span class="p">],</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>

<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)   # use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                 <span class="c1"># output the combined plot</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>../data/Mystery_Reaction.csv
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Reactant</th>
      <th>Product A</th>
      <th>Product B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0000</td>
      <td>0.250</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0195</td>
      <td>0.231</td>
      <td>0.00563</td>
      <td>0.0131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0416</td>
      <td>0.213</td>
      <td>0.01090</td>
      <td>0.0267</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/e8abd9903be2e077fc83c9bc131aa1783a2b40df5fba4daa5ced64a83299dc4e.png" src="../_images/e8abd9903be2e077fc83c9bc131aa1783a2b40df5fba4daa5ced64a83299dc4e.png" />
</div>
</div>
</div>
<div class="section" id="linear-models">
<h2>Linear Models<a class="headerlink" href="#linear-models" title="Permalink to this headline">#</a></h2>
<p>We know the integrated rate laws for 1<span class="math notranslate nohighlight">\(^{st}\)</span> and 2<span class="math notranslate nohighlight">\(^{nd}\)</span> order reactions and we can plot the linearized versions of these rate laws for the dissappearance of the reactant.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p>Reaction</p></th>
<th class="text-center head"><p>Order</p></th>
<th class="text-center head"><p>Rate Law</p></th>
<th class="text-center head"><p>Integrated Law</p></th>
<th class="text-center head"><p>Linear Form</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>$<span class="math notranslate nohighlight">\({A}\xrightarrow{k_{obs}}{P}\)</span>$</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(-\frac{\partial A}{\partial t}  = k_{obs}\cdot A\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\( A_t = A_0 \cdot e^{-k_{obs}t}\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\( \ln{A_t}  = \ln{A_t} - k\cdot t\)</span>$</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>$<span class="math notranslate nohighlight">\({2A}\xrightarrow{k_{obs}}{P}\)</span>$</p></td>
<td class="text-center"><p>2</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(-\frac{\partial A}{\partial t} = k_{obs}\cdot A^2\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\( {A_t} = \frac{A_0}{1 + A_0k_{obs} t}\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\( \frac{1}{A_t} = \frac{1}{A_0} + k_{obs}\cdot t\)</span>$</p></td>
</tr>
</tbody>
</table>
<p>I expect this to to be a first order reaction because both reactions that consume the reactant are first order. Let us plot the two linear models and see if that is indeed the case.</p>
<p>We will plot <span class="math notranslate nohighlight">\(\ln{A_t}\)</span> vs. <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(\frac{1}{\left[ A_t \right]}\)</span> vs. <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p><em>As a bonus, the code below will show you how to make two plots within a figure.</em></p>
<div class="section" id="observations">
<h3>Observations<a class="headerlink" href="#observations" title="Permalink to this headline">#</a></h3>
<p>The reaction is indeed first order and the rate constant was found to be <span class="math notranslate nohighlight">\(4.01~s^{-1}\)</span> for dissappearance of reactant. Assuming that the two products are the only products, we can get the rate consant for each by the ratio of product A to product B. In the example below I just used the ratio at a given time point.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################</span>
<span class="c1">### import packages ###</span>
<span class="c1">#######################</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>


<span class="c1">#####################</span>
<span class="c1">### Load data set ###</span>
<span class="c1">#####################</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Mystery_Reaction.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;6_PhysOrgExamples/&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>         <span class="c1"># Load data from .csv format into dataframe</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>                   <span class="c1"># strip away any lines with &quot;NaN&quot; values (blanks)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                <span class="c1"># Show header and first three lines of dataframe</span>


<span class="c1">##################################################</span>
<span class="c1">### Setup a figure with two plots side-by-side ###</span>
<span class="c1">### and choose a stylesheet                    ###</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>


<span class="c1">#####################################################</span>
<span class="c1">### Get series of data to plot from the dataframe ###</span>
<span class="c1">#####################################################</span>

<span class="n">ReciprocalA</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Reactant&quot;</span><span class="p">]</span>
<span class="n">lnA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Reactant&quot;</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>


<span class="c1">#########################################</span>
<span class="c1">### The first plot is in position 0.  ###</span>
<span class="c1">### ax[0] addresses that plot.        ###</span>
<span class="c1">#########################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lnA</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Linear Plot for First Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\ln{\left[ A_t \right]}$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0,100],                  </span>
<span class="c1">#          ylim=[-1,7]</span>
         <span class="p">)</span>

<span class="c1">### Linear line fit and plot the line fit ###</span>

<span class="n">linfit1</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lnA</span><span class="p">)</span>
<span class="n">fity</span> <span class="o">=</span> <span class="n">linfit1</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">linfit1</span><span class="o">.</span><span class="n">intercept</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>


<span class="c1">##########################################</span>
<span class="c1">### The second plot is in position 0.  ###</span>
<span class="c1">### ax[0] addresses that plot.         ###</span>
<span class="c1">##########################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ReciprocalA</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Linear Plot for Second Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}</span><span class="s2">{\left[ A_t \right]}$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0,100],                  </span>
<span class="c1">#          ylim=[-1,7]</span>
         <span class="p">)</span>

<span class="c1">### Linear line fit and plot the line fit ###</span>

<span class="n">linfit2</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ReciprocalA</span><span class="p">)</span>
<span class="n">fity</span><span class="o">=</span><span class="n">linfit2</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">linfit2</span><span class="o">.</span><span class="n">intercept</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)   # use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                 <span class="c1"># output the combined four plots</span>


<span class="c1">################################################</span>
<span class="c1">### Print out the calculated rate constants  ###</span>
<span class="c1">################################################</span>

<span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="n">linfit1</span><span class="o">.</span><span class="n">slope</span> 
                                                                       <span class="c1"># 2 * stderr = 95% confidence interval</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The reaction is first order with a rate constant of </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">linfit1</span><span class="o">.</span><span class="n">stderr</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> s^-1 &quot;</span><span class="p">)</span>

<span class="n">k_A</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product B&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>   <span class="c1"># I used the ratio at time point #5</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The rate consant for formation of Product A is </span><span class="si">{</span><span class="n">k_A</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">k_B</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product B&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product B&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The rate consant for formation of Product B is </span><span class="si">{</span><span class="n">k_B</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Reactant</th>
      <th>Product A</th>
      <th>Product B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0195</td>
      <td>0.231</td>
      <td>0.00563</td>
      <td>0.0131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0416</td>
      <td>0.213</td>
      <td>0.01090</td>
      <td>0.0267</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0646</td>
      <td>0.194</td>
      <td>0.01630</td>
      <td>0.0400</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/d2d91cb5c94221cd7ce13e1231693b03135e032c30a17b555a2f9ffc33d0d0ac.png" src="../_images/d2d91cb5c94221cd7ce13e1231693b03135e032c30a17b555a2f9ffc33d0d0ac.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The reaction is first order with a rate constant of 4.01 +/- 0.010 s^-1 
The rate consant for formation of Product A is 1.16
The rate consant for formation of Product B is 2.85
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="curve-fits">
<h2>Curve Fits<a class="headerlink" href="#curve-fits" title="Permalink to this headline">#</a></h2>
<p>Linear fits are so “Excel”. The modern chemist might choose to fit the data to the model directly. We have two models, the integrated rate equations for <span class="math notranslate nohighlight">\(1^{st}\)</span> and <span class="math notranslate nohighlight">\(2^{nd}\)</span> order reactions.</p>
<p>First we will define two functions that describe each case and then fit the data for [Reactant] against them. Note the code below.</p>
<div class="section" id="id1">
<h3>Observations<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>The first order fit matched the data and the second order fit did not.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################</span>
<span class="c1">### import packages ###</span>
<span class="c1">#######################</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>


<span class="c1">#####################</span>
<span class="c1">### Load data set ###</span>
<span class="c1">#####################</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Mystery_Reaction.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;6_PhysOrgExamples/&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>         <span class="c1"># Load data from .csv format into dataframe</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>                   <span class="c1"># strip away any lines with &quot;NaN&quot; values (blanks)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                <span class="c1"># Show header and first three lines of dataframe</span>


<span class="c1">####################################################</span>
<span class="c1">### Functions that define models for curve fits  ###</span>
<span class="c1">####################################################</span>

<span class="c1">### Define function for first order integrated rate law</span>
<span class="k">def</span> <span class="nf">First</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">A0</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="c1">### Define function for second order integrated rate law</span>
<span class="k">def</span> <span class="nf">Second</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">A0</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">A0</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span>


<span class="c1">##################################################</span>
<span class="c1">### Setup a figure with two plots side-by-side ###</span>
<span class="c1">### and choose a stylesheet                    ###</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>


<span class="c1">#####################################################</span>
<span class="c1">### Get series of data to plot from the dataframe ###</span>
<span class="c1">#####################################################</span>

<span class="n">At</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Reactant&quot;</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>


<span class="c1">#########################################</span>
<span class="c1">### The first plot is in position 0.  ###</span>
<span class="c1">### ax[0] addresses that plot.        ###</span>
<span class="c1">#########################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">At</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curve Fit for First Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\left[ A_t \right]$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0,100],                  </span>
<span class="c1">#          ylim=[-1,7]</span>
          <span class="p">)</span>   

<span class="c1">### perform curve fit for first order reaction.</span>
<span class="n">popt1</span><span class="p">,</span> <span class="n">pcov1</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">First</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">At</span><span class="p">)</span> 
<span class="c1">### curve_fit returns a list of optimized parameters (popt) and matrix of covariance values (pcov)</span>

<span class="c1">#print(popt)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">popt1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># optimized parameters are in the order in which the appear in the function definition</span>
<span class="n">A0</span> <span class="o">=</span> <span class="n">popt1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">### plot curve fit for first order reaction.</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fity</span><span class="o">=</span><span class="n">First</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">A0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>


<span class="c1">##########################################</span>
<span class="c1">### The second plot is in position 0.  ###</span>
<span class="c1">### ax[0] addresses that plot.         ###</span>
<span class="c1">##########################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">At</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curve Fit for Second Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\left[ A_t \right]$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0,100],                  </span>
<span class="c1">#          ylim=[-1,7]</span>
          <span class="p">)</span>                   

<span class="c1">### perform curve fit for second order reaction.</span>
<span class="n">popt2</span><span class="p">,</span> <span class="n">pcov2</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">Second</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">At</span><span class="p">)</span>
<span class="c1">#print(popt)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">popt2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">A0</span> <span class="o">=</span> <span class="n">popt2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">### plot curve fit for first order reaction.</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fity</span><span class="o">=</span><span class="n">Second</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">A0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>


<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)   # use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                 <span class="c1"># output the combined four plots</span>


<span class="n">k</span> <span class="o">=</span> <span class="n">popt1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The reaction is first order with a rate constant of </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Reactant</th>
      <th>Product A</th>
      <th>Product B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0195</td>
      <td>0.231</td>
      <td>0.00563</td>
      <td>0.0131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0416</td>
      <td>0.213</td>
      <td>0.01090</td>
      <td>0.0267</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0646</td>
      <td>0.194</td>
      <td>0.01630</td>
      <td>0.0400</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/f6df6a771c91466b70edfb894520275c73c8bc0a46d08a756bf56c870e4e3e75.png" src="../_images/f6df6a771c91466b70edfb894520275c73c8bc0a46d08a756bf56c870e4e3e75.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The reaction is first order with a rate constant of 4.00
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluating-the-curve-fits">
<h2>Evaluating the Curve Fits<a class="headerlink" href="#evaluating-the-curve-fits" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">SciPy.optimize.curve_fit()</span></code> function does not calculate the value of <span class="math notranslate nohighlight">\(R^2\)</span>. This is because the authors of that tool do not consider <span class="math notranslate nohighlight">\(R^2\)</span> to be a useful measure of fit quality. I am not statistician, but I do agree with them.</p>
<p>Nevertheless, we as chemists see <span class="math notranslate nohighlight">\(R^2\)</span> used all the time. So let’s be bad and use it here. The code below will calculate the <span class="math notranslate nohighlight">\(R^2\)</span> for each plot.</p>
<p>One better way to evaluate a fit is to plot the residuals. If error is random and the fit is good then the residuals should appear evenly above and below zero.  But if the fit is not good, we will see the residuals drift up and down as the model deviates from the data beyond random error.</p>
<p>Also, in the code below is the plots of the residuals. I plotted both using the same scale. Which method is more convincing?</p>
<div class="section" id="id2">
<h3>Observations<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>The values of <span class="math notranslate nohighlight">\(R^2\)</span> for both fits are great! One is perfect and the other is still a good value by the standards of physical organic chemistry (<span class="math notranslate nohighlight">\(R^2 &gt; 0.95\)</span> is considered a good fit by almost everyone except analytical chemists). If we had just relied on the <span class="math notranslate nohighlight">\(R^2\)</span> values alone we might have choosen the wrong model.</p>
<p>But, you chose the right model because you used you eyes to look at the fits and one clearly did not match. Always plot the curve fit on the data and judge harshly to evaluate a curve fit.  A more rigourous way would be to plot the residuals. The residuals were fairly evenly distributed above and below the zero line in both cases (hence the seemingly good <span class="math notranslate nohighlight">\(R^2\)</span> scores) but we clearly see that one is not random and has a systematic deviation diagnostic of a poor model fit.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################</span>
<span class="c1">### Load data set ###</span>
<span class="c1">#####################</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Mystery_Reaction.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;6_PhysOrgExamples/&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>         <span class="c1"># Load data from .csv format into dataframe</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>                   <span class="c1"># strip away any lines with &quot;NaN&quot; values (blanks)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                <span class="c1"># Show header and first three lines of dataframe</span>


<span class="c1">#####################################################</span>
<span class="c1">### Get series of data to plot from the dataframe ###</span>
<span class="c1">#####################################################</span>

<span class="n">At</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Reactant&quot;</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>

<span class="n">xdata</span><span class="o">=</span><span class="n">t</span>   <span class="c1"># The code that I stole from the web uses these terms for x and y data.</span>
<span class="n">ydata</span><span class="o">=</span><span class="n">At</span>


<span class="c1">##################################################</span>
<span class="c1">### Setup a figure with two plots side-by-side ###</span>
<span class="c1">### and choose a stylesheet                    ###</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>


<span class="c1">################################################</span>
<span class="c1">### Calculate R^2 for first-order model fit  ###</span>
<span class="c1">################################################</span>

<span class="n">residuals</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">-</span> <span class="n">First</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt1</span><span class="p">)</span>
<span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">r_squared_model_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>


<span class="c1">#########################################################</span>
<span class="c1">### Plot the residuals for first-order model in ax[0] ###</span>
<span class="c1">#########################################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Residual for First Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Residual Values&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.030</span><span class="p">,</span><span class="mf">0.015</span><span class="p">],</span>       <span class="c1"># I set the y-axis limits so both plots have same scale           </span>
<span class="c1">#          xlim=[-1,7]</span>
          <span class="p">)</span>   


<span class="c1">#################################################</span>
<span class="c1">### Calculate R^2 for second-order model fit  ###</span>
<span class="c1">#################################################</span>

<span class="n">residuals</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">-</span> <span class="n">Second</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt2</span><span class="p">)</span>
<span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">r_squared_model_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>

<span class="c1">##########################################################</span>
<span class="c1">### Plot the residuals for second-order model in ax[1] ###</span>
<span class="c1">##########################################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Residual for Second Order&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Residual Values&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.030</span><span class="p">,</span><span class="mf">0.015</span><span class="p">],</span>                  
<span class="c1">#          xlim=[-1,7]</span>
          <span class="p">)</span>   


<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)   # use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                 <span class="c1"># output the two plots</span>


<span class="c1">###########################################</span>
<span class="c1">### print the calculated values for R^2 ###</span>
<span class="c1">###########################################</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the R^2 value for the first-order model fit is </span><span class="si">{</span><span class="n">r_squared_model_1</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the R^2 value for the second-order model fit is </span><span class="si">{</span><span class="n">r_squared_model_2</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Reactant</th>
      <th>Product A</th>
      <th>Product B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0195</td>
      <td>0.231</td>
      <td>0.00563</td>
      <td>0.0131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0416</td>
      <td>0.213</td>
      <td>0.01090</td>
      <td>0.0267</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0646</td>
      <td>0.194</td>
      <td>0.01630</td>
      <td>0.0400</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/4b80fb588aa93093f1f924dd680062d2b91fc770220e12227049e914ccaee191.png" src="../_images/4b80fb588aa93093f1f924dd680062d2b91fc770220e12227049e914ccaee191.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the R^2 value for the first-order model fit is 0.9999
the R^2 value for the second-order model fit is 0.9599
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-two-products">
<h2>The Two products<a class="headerlink" href="#the-two-products" title="Permalink to this headline">#</a></h2>
<p>We fit the disappearance of reactant to the first order model and obtained a value for the rate constant for the change. However, that rate constant is actually the total value of the two rate constants. The reactions were…</p>
<div class="math notranslate nohighlight">
\[\begin{split} A \xrightarrow{k_1} B \\
A \xrightarrow{k_2} C\end{split}\]</div>
<p>And the rate constant for dissappearance of reactant, <span class="math notranslate nohighlight">\(k_{obs}\)</span>, is <span class="math notranslate nohighlight">\(k_1 + k_2\)</span>. We can easily obtain these values since we know the total and the ratio between then. The ratio of the rate consants will be the ratio of the concentrations of the two products.</p>
<p>We could also calculate the total rate consant, <span class="math notranslate nohighlight">\(k_{obs}\)</span> with a curve fit of the products vs. time. The integrated rate equation for product in a first order reaction is…</p>
<div class="math notranslate nohighlight">
\[P_t = P_\infty - \cdot P_\infty e^{-k_{obs}t}\]</div>
<p>We don’t know the final concentration of product, <span class="math notranslate nohighlight">\(P_\infty\)</span>, but if we have enough data the curve fit should be able to determine it as well. The code below fits the data for the two products to the integrated rate equation above. Remember that <span class="math notranslate nohighlight">\(k_{obs} = k_1 + k_2\)</span>. Both products will have the same apparent rate constant but the individual rate constants can be easily found through the ratio of <span class="math notranslate nohighlight">\(\frac{\left[ B \right]}{\left[ C \right]}=\frac{k_1}{k_2}\)</span>.</p>
<p>In the code below I also use the covariance matrix, <code class="docutils literal notranslate"><span class="pre">pcov</span></code>, to calculate the standard deviation for each value.</p>
<div class="section" id="id3">
<h3>Observations<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>In both cases the <span class="math notranslate nohighlight">\(k_{obs}\)</span> was near 4.0. True confession: I used a value of 4 for <span class="math notranslate nohighlight">\(k_{obs}\)</span> when I created the data.  However, rounding errors when I created the data set have resulted in slightly different answers when <span class="math notranslate nohighlight">\(k_{obs}\)</span> was determined from the decay of A or the appearance of B or C.</p>
<p>In this last case I will use the calculated values of <span class="math notranslate nohighlight">\(\left[ B\right]_{\infty}\)</span> and <span class="math notranslate nohighlight">\(\left[ C\right]_{\infty}\)</span> for the ratio of the two rate constants.  We know that…</p>
<div class="math notranslate nohighlight">
\[ \frac{k_1}{k_2} = \frac{\left[ B\right]_{\infty}}{\left[ C\right]_{\infty}} \]</div>
<p>and
$<span class="math notranslate nohighlight">\( k_{obs} = k_1 + k_2 \)</span>$</p>
<p>Thus we can calculate values for <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(k_2\)</span>.</p>
<p>Using the <span class="math notranslate nohighlight">\(k_{obs}\)</span> from B, we calculate that <span class="math notranslate nohighlight">\(k_1 = 1.14 s^{-1}\)</span> and <span class="math notranslate nohighlight">\(k_2 = 2.63 s^{-1}\)</span></p>
<p>Using the <span class="math notranslate nohighlight">\(k_{obs}\)</span> from C, we calculate that <span class="math notranslate nohighlight">\(k_1 = 1.22 s^{-1}\)</span> and <span class="math notranslate nohighlight">\(k_2 = 2.80 s^{-1}\)</span></p>
<p>These compare well to the values calculated from A and the ratio of B/C at time point 5 which were <span class="math notranslate nohighlight">\(k_1 = 1.16 s^{-1}\)</span> and <span class="math notranslate nohighlight">\(k_2 = 2.85 s^{-1}\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="c1">#####################</span>
<span class="c1">### Load data set ###</span>
<span class="c1">#####################</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Mystery_Reaction.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;6_PhysOrgExamples/&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>         <span class="c1"># Load data from .csv format into dataframe</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>                   <span class="c1"># strip away any lines with &quot;NaN&quot; values (blanks)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                <span class="c1"># Show header and first three lines of dataframe</span>

<span class="c1">####################################################</span>
<span class="c1">### Functions that define models for curve fits  ###</span>
<span class="c1">####################################################</span>

<span class="c1">### Define function for product in second order integrated rate law</span>
<span class="k">def</span> <span class="nf">Product</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">P_inf</span><span class="p">):</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">P_inf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">P</span>


<span class="c1">##################################################</span>
<span class="c1">### Setup a figure with two plots side-by-side ###</span>
<span class="c1">### and choose a stylesheet                    ###</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                     <span class="c1"># add 7% empty space around outside of plot area   </span>


<span class="c1">#####################################################</span>
<span class="c1">### Get series of data to plot from the dataframe ###</span>
<span class="c1">#####################################################</span>

<span class="n">Bt</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">]</span>
<span class="n">Ct</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product B&quot;</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>


<span class="c1">####################################################################</span>
<span class="c1">### Plot the data and curve fit for product B vs. time in ax[0]  ###</span>
<span class="c1">####################################################################</span>

<span class="c1">### Plot data and setup labels</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curve Fits for products&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\left[ A_t \right]$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
<span class="c1">#          xlim=[0,100],                  </span>
<span class="c1">#          ylim=[-1,7]</span>
          <span class="p">)</span>   

<span class="c1">### perform curve fit for first order reaction. Product B</span>
<span class="n">popt1</span><span class="p">,</span> <span class="n">pcov1</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">Product</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.3</span><span class="p">])</span> <span class="c1"># p0 is a list of initial guesses for parameters</span>
<span class="c1">#print(popt1)</span>
<span class="n">k1</span> <span class="o">=</span> <span class="n">popt1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">B_inf</span> <span class="o">=</span> <span class="n">popt1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">### Calculate standard deviations from covariance matrix</span>
<span class="p">[</span><span class="n">stdev_k1</span><span class="p">,</span> <span class="n">stdev_B_inf</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov1</span><span class="p">))</span>

<span class="c1">### plot curve fit for first order reaction. Product B</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fity</span><span class="o">=</span><span class="n">Product</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">B_inf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>


<span class="c1">####################################################################</span>
<span class="c1">### Plot the data and curve fit for product B vs. time in ax[0]  ###</span>
<span class="c1">####################################################################</span>

<span class="c1">### Plot data</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Ct</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>

<span class="c1">### perform curve fit for first order reaction. Product C</span>
<span class="n">popt2</span><span class="p">,</span> <span class="n">pcov2</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">Product</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Ct</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.3</span><span class="p">])</span> <span class="c1"># p0 is a list of initial guesses for parameters</span>
<span class="c1">#print(popt2)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="n">popt2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">C_inf</span> <span class="o">=</span> <span class="n">popt2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="p">[</span><span class="n">stdev_k2</span><span class="p">,</span> <span class="n">stdev_C_inf</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov2</span><span class="p">))</span>

<span class="c1">### plot curve fit for first order reaction. Product C</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fity</span><span class="o">=</span><span class="n">Product</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">C_inf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">fity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>


<span class="c1">###########################################################</span>
<span class="c1">### Plot the residuals for product B vs. time in ax[1]  ###</span>
<span class="c1">###########################################################</span>

<span class="n">xdata</span><span class="o">=</span><span class="n">t</span>  <span class="c1"># The code that I stole from the web uses these terms for x and y data.</span>
<span class="n">ydata</span><span class="o">=</span><span class="n">Bt</span>

<span class="c1">### Calculate R^2 for First order fit</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">-</span> <span class="n">Product</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt1</span><span class="p">)</span>
<span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">r_squared_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>

<span class="c1">### Plot the residuals in ax[1]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>


<span class="c1">###########################################################</span>
<span class="c1">### Plot the residuals for product B vs. time in ax[1]  ###</span>
<span class="c1">###########################################################</span>

<span class="n">xdata</span><span class="o">=</span><span class="n">t</span>   <span class="c1"># The code that I stole from the web uses these terms for x and y data.</span>
<span class="n">ydata</span><span class="o">=</span><span class="n">Ct</span>

<span class="c1">### Calculate R^2 for second-order model fit</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">-</span> <span class="n">Product</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt2</span><span class="p">)</span>
<span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">r_squared_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>

<span class="c1">### Plot the residuals in ax[1]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>

<span class="c1">### Set up axis labels for ax[1]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Residual for Product Curve Fits&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Residuals Values&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time /s&quot;</span><span class="p">,</span>                
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.005</span><span class="p">],</span>                  
<span class="c1">#          xlim=[-1,7]</span>
          <span class="p">)</span>   

<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)   # use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                 <span class="c1"># output the two plots</span>


<span class="c1">###########################################</span>
<span class="c1">### print the calculated values for R^2 ###</span>
<span class="c1">### print parameters with standard dev. ###</span>
<span class="c1">###########################################</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the R^2 value for the second-order model for A -&gt; C fit is </span><span class="si">{</span><span class="n">r_squared_2</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the R^2 value for the first-order model for A -&gt; B fit is </span><span class="si">{</span><span class="n">r_squared_1</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The combined rate constant, k_obs, using [B] is </span><span class="si">{</span><span class="n">k1</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">stdev_k1</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The final conc. of B is </span><span class="si">{</span><span class="n">B_inf</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">stdev_B_inf</span><span class="si">:</span><span class="s2">0.5f</span><span class="si">}</span><span class="s2"> moles/L&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The combined rate constant, k_obs, using [C] is </span><span class="si">{</span><span class="n">k2</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">stdev_k2</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The final conc. of C is </span><span class="si">{</span><span class="n">C_inf</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">stdev_C_inf</span><span class="si">:</span><span class="s2">0.5f</span><span class="si">}</span><span class="s2"> moles/L&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Reactant</th>
      <th>Product A</th>
      <th>Product B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0195</td>
      <td>0.231</td>
      <td>0.00563</td>
      <td>0.0131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0416</td>
      <td>0.213</td>
      <td>0.01090</td>
      <td>0.0267</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0646</td>
      <td>0.194</td>
      <td>0.01630</td>
      <td>0.0400</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/95e124a2f701a753154ccee854ca9bbb5cd6eb92eee0b687c45f1f1c087e974e.png" src="../_images/95e124a2f701a753154ccee854ca9bbb5cd6eb92eee0b687c45f1f1c087e974e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the R^2 value for the second-order model for A -&gt; C fit is 0.9999
the R^2 value for the first-order model for A -&gt; B fit is 0.9995

The combined rate constant, k_obs, using [B] is 3.78 +/- 0.108 /s
The final conc. of B is 0.076 +/- 0.00103 moles/L
The combined rate constant, k_obs, using [C] is 4.02 +/- 0.046 /s
The final conc. of C is 0.175 +/- 0.00092 moles/L
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-data-set">
<h2>The Data Set<a class="headerlink" href="#the-data-set" title="Permalink to this headline">#</a></h2>
<p>Take the following data and create a text file named <code class="docutils literal notranslate"><span class="pre">Mystery_Reaction.csv</span></code> in the same directory as the Jupyter notebook.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>time,Reactant,Product A,Product B
0.00E+00,2.50E-01,,
1.95E-02,2.31E-01,5.63E-03,1.31E-02
4.16E-02,2.13E-01,1.09E-02,2.67E-02
6.46E-02,1.94E-01,1.63E-02,4.00E-02
9.19E-02,1.75E-01,2.17E-02,5.33E-02
1.19E-01,1.56E-01,2.71E-02,6.66E-02
1.51E-01,1.38E-01,3.26E-02,7.99E-02
1.87E-01,1.19E-01,3.85E-02,9.28E-02
2.29E-01,1.00E-01,4.43E-02,1.06E-01
2.80E-01,8.13E-02,5.04E-02,1.18E-01
3.48E-01,6.25E-02,5.61E-02,1.31E-01
4.35E-01,4.38E-02,6.19E-02,1.44E-01
5.74E-01,2.50E-02,6.80E-02,1.57E-01
9.21E-01,6.25E-03,7.30E-02,1.71E-01
2.92E+00,,7.48E-02,1.75E-01
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./6_PhysOrgExamples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="6_1_start.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Integrating Rate Equations with Python</p>
      </div>
    </a>
    <a class="right-next"
       href="6_3_Problem_ch7_p5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Problem 5, Ch. 7</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#order-of-reaction">Order of Reaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models">Linear Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fits">Curve Fits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-curve-fits">Evaluating the Curve Fits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-two-products">The Two products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Observations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-set">The Data Set</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Barry Linkletter
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>